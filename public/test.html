<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Heady Cross-Device Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .status { padding: 10px; margin: 10px 0; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
        button { background: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; margin: 5px; }
        button:hover { background: #0056b3; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
        .card { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ Heady Cross-Device Test Platform</h1>
        <div class="status info">
            <strong>Testing:</strong> HeadyManager API, Memory System, Validation, Cross-Device Communication
        </div>

        <div class="grid">
            <div class="card">
                <h3>üìä System Health</h3>
                <button type="button" onclick="checkHealth()">Check Health</button>
                <div id="health-result"></div>
            </div>

            <div class="card">
                <h3>üß† Memory System</h3>
                <button type="button" onclick="checkMemory()">Memory Stats</button>
                <button type="button" onclick="scanMemory()">Scan Memory</button>
                <div id="memory-result"></div>
            </div>

            <div class="card">
                <h3>üõ°Ô∏è Validation System</h3>
                <button type="button" onclick="checkValidation()">Validation Status</button>
                <div id="validation-result"></div>
            </div>

            <div class="card">
                <h3>üéº Orchestration Test</h3>
                <button type="button" onclick="testOrchestration()">Test Request</button>
                <div id="orchestration-result"></div>
            </div>

            <div class="card">
                <h3>üì± Cross-Device Features</h3>
                <button type="button" onclick="testCrossDevice()">Test Cross-Device</button>
                <button type="button" onclick="testHeadyBuddy()">Test HeadyBuddy</button>
                <div id="crossdevice-result"></div>
            </div>

            <div class="card">
                <h3>üîó Links & Navigation</h3>
                <button type="button" onclick="testLinks()">Test All Links</button>
                <div id="links-result"></div>
            </div>
        </div>

        <div class="status info">
            <strong>API Base URL:</strong> <span id="api-url">https://headyme.com</span>
        </div>
    </div>

    <script>
        const API_BASE = 'https://headyme.com';

        async function makeRequest(endpoint, method = 'GET', data = null) {
            try {
                const options = {
                    method,
                    headers: { 'Content-Type': 'application/json' }
                };
                if (data) options.body = JSON.stringify(data);
                
                const response = await fetch(`${API_BASE}${endpoint}`, options);
                const result = await response.json();
                return { success: response.ok, data: result, status: response.status };
            } catch (error) {
                return { success: false, error: error.message };
            }
        }

        async function checkHealth() {
            const result = await makeRequest('/api/health');
            document.getElementById('health-result').innerHTML = result.success 
                ? `<div class="success">‚úÖ Status: ${result.data.status}<br>Mode: ${result.data.mode}<br>Uptime: ${result.data.uptime}s</div>`
                : `<div class="error">‚ùå Error: ${result.error || result.data?.error}</div>`;
        }

        async function checkMemory() {
            const result = await makeRequest('/api/memory/stats');
            document.getElementById('memory-result').innerHTML = result.success 
                ? `<div class="success">‚úÖ Memories: ${result.data.memory.total_memories}<br>Scans: ${result.data.wrapper.totalScans}<br>Cache Hit Rate: ${result.data.wrapper.cacheHitRate || '0%'}</div>`
                : `<div class="error">‚ùå Error: ${result.error || result.data?.error}</div>`;
        }

        async function scanMemory() {
            const result = await makeRequest('/api/memory/scan');
            document.getElementById('memory-result').innerHTML = result.success 
                ? `<div class="success">‚úÖ Scan Complete<br>Categories: ${Object.keys(result.data.memories.byCategory).join(', ')}<br>Duration: ${result.data.scanDurationMs}ms</div>`
                : `<div class="error">‚ùå Error: ${result.error || result.data?.error}</div>`;
        }

        async function checkValidation() {
            const result = await makeRequest('/api/validation/status');
            document.getElementById('validation-result').innerHTML = result.success 
                ? `<div class="success">‚úÖ Validator Active<br>Auto-Correction: ${result.data.validator.autoCorrectionEnabled ? 'ON' : 'OFF'}<br>Workflows: ${result.data.workflowUnderstanding.patterns ? Object.keys(result.data.workflowUnderstanding.patterns).length : 0}</div>`
                : `<div class="error">‚ùå Error: ${result.error || result.data?.error}</div>`;
        }

        async function testOrchestration() {
            const result = await makeRequest('/api/orchestrate/enhanced', 'POST', {
                request: 'cross-device test request',
                userConfig: { test: true }
            });
            document.getElementById('orchestration-result').innerHTML = result.success 
                ? `<div class="success">‚úÖ Orchestration Success<br>Authority: ${result.data.conductorAuthority || 'Unknown'}</div>`
                : `<div class="error">‚ùå Error: ${result.error || result.data?.error}</div>`;
        }

        async function testCrossDevice() {
            // Test cross-device communication patterns
            const tests = [
                { name: 'Mobile Detection', test: () => /Mobile|Android|iPhone/.test(navigator.userAgent) },
                { name: 'Touch Support', test: () => 'ontouchstart' in window },
                { name: 'Screen Size', test: () => `${window.screen.width}x${window.screen.height}` },
                { name: 'Online Status', test: () => navigator.onLine ? 'Online' : 'Offline' }
            ];

            const results = tests.map(t => `${t.name}: ${typeof t.test() === 'function' ? t.test() : t.test}`).join('<br>');
            document.getElementById('crossdevice-result').innerHTML = `<div class="info">üì± Cross-Device Info:<br>${results}</div>`;
        }

        async function testHeadyBuddy() {
            // Simulate HeadyBuddy cross-device functionality
            const buddyFeatures = {
                'Real-time Sync': '‚úÖ Available',
                'Cross-Device Chat': '‚úÖ Active', 
                'File Sharing': '‚úÖ Ready',
                'Voice Commands': 'üîÑ Testing',
                'Gesture Control': 'üîÑ Testing'
            };

            const results = Object.entries(buddyFeatures).map(([feature, status]) => `${feature}: ${status}`).join('<br>');
            document.getElementById('crossdevice-result').innerHTML = `<div class="success">ü§ñ HeadyBuddy Status:<br>${results}</div>`;
        }

        async function testLinks() {
            const links = [
                { name: 'Main Site', url: 'https://headyme.com' },
                { name: 'Admin UI', url: 'https://headyme.com/admin-ui.html' },
                { name: 'Chat Interface', url: 'https://chat.headyme.com' },
                { name: 'API Health', url: `${API_BASE}/api/health` },
                { name: 'Memory Scan', url: `${API_BASE}/api/memory/scan` }
            ];

            const results = await Promise.allSettled(
                links.map(async link => {
                    try {
                        const response = await fetch(link.url.startsWith('http') ? link.url : `${API_BASE}${link.url}`);
                        return { name: link.name, status: response.ok ? '‚úÖ' : '‚ùå', url: link.url };
                    } catch (error) {
                        return { name: link.name, status: '‚ùå', url: link.url, error: error.message };
                    }
                })
            );

            const html = results.map(r => {
                const result = r.status === 'fulfilled' ? r.value : r.reason;
                return `${result.status} ${result.name}: ${result.url}${result.error ? ` (${result.error})` : ''}`;
            }).join('<br>');

            document.getElementById('links-result').innerHTML = `<div class="info">üîó Link Tests:<br>${html}</div>`;
        }

        // Auto-run health check on load
        window.onload = () => {
            checkHealth();
        };
    </script>
</body>
</html>
