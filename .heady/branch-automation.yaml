# ðŸ”„ Branch Automation Configuration
# Automated branch management with HeadySims + HeadyBattle integration

id: branch-automation
name: HeadyBranchAutomation
version: 3.0.0
type: automation
owner: core

enabled: true
continuous_mode: true
validation_required: true

branches:
  development:
    description: "IDE integration and windsurf-next changes"
    source: "windsurf-next IDE"
    destination: "staging"
    triggers:
      - git_commit
      - file_change
      - ide_save
    validation:
      - HeadyBattle_method
      - basic_syntax_check
      - dependency_validation
    
  staging:
    description: "Arena Mode with HeadySims simulations"
    source: "development"
    destination: "main"
    triggers:
      - development_merge
      - arena_completion
      - monte_carlo_ready
    validation:
      - arena_mode_tournament
      - monte_carlo_confidence
      - HeadyBattle_final_validation
      - performance_thresholds
    
  main:
    description: "Production deployment"
    source: "staging"
    destination: "production"
    triggers:
      - staging_promotion
      - manual_approval
      - emergency_deploy
    validation:
      - final_HeadyBattle_approval
      - production_readiness
      - security_scan
      - performance_benchmarks

automation_rules:
  development_to_staging:
    enabled: true
    auto_trigger: true
    validation_required: true
    
    conditions:
      - no_syntax_errors
      - HeadyBattle_score >= 0.80
      - no_critical_issues
      - tests_passing
      
    actions:
      - detect_changes
      - apply_HeadyBattle_method
      - generate_monte_carlo_candidates
      - create_commit
      - merge_to_staging
      - trigger_arena_mode
      
    rollback_conditions:
      - HeadyBattle_validation_failed
      - syntax_errors_detected
      - tests_failing
      - user_intervention

  staging_to_main:
    enabled: true
    auto_trigger: false  # Requires Arena Mode completion
    validation_required: true
    
    conditions:
      - arena_mode_completed
      - monte_carlo_confidence >= 0.85
      - HeadyBattle_final_score >= 0.85
      - performance_thresholds_met
      - no_blocking_issues
      
    actions:
      - validate_arena_results
      - check_monte_carlo_confidence
      - final_HeadyBattle_validation
      - intelligent_squash_merge
      - create_production_tag
      - deploy_to_production
      
    rollback_conditions:
      - arena_mode_failed
      - confidence_below_threshold
      - HeadyBattle_rejection
      - performance_degradation

validation_criteria:
  HeadyBattle_method:
    minimum_score: 0.80
    critical_questions_required: true
    ethical_validation_required: true
    
  monte_carlo:
    minimum_confidence: 0.85
    strategy_diversity_required: true
    convergence_validation: true
    
  arena_mode:
    tournament_completion_required: true
    winner_score_threshold: 0.75
    no_stagnation_periods: 5
    
  performance:
    latency_threshold: 1000  # ms
    accuracy_threshold: 0.95
    resource_efficiency_threshold: 0.80

monitoring:
  real_time:
    - branch_status
    - validation_results
    - automation_queue
    - error_rates
    
  alerts:
    - validation_failure
    - automation_stuck
    - performance_degradation
    - security_issues
    
  logging:
    - all_automation_actions
    - validation_results
    - branch_transitions
    - error_details

integration_points:
  monte_carlo:
    - candidate_generation
    - confidence_validation
    - strategy_selection
    
  HeadyBattle:
    - change_interrogation
    - ethical_validation
    - final_approval
    
  arena_mode:
    - tournament_triggering
    - result_validation
    - promotion_decision
    
  ide_integration:
    - windsurf_next_detection
    - change_monitoring
    - auto_commit_generation

safety_features:
  manual_override: true
  emergency_stop: true
  rollback_capability: true
  human_review_gates:
    - staging_to_main
    - emergency_deployments
    - security_issues

api:
  base_path: /api/branch-automation
  endpoints:
    - GET /status
    - GET /branches
    - POST /trigger-sync
    - GET /validation-results
    - POST /manual-override
    - GET /automation-queue

environment_variables:
  BRANCH_AUTOMATION_ENABLED: true
  CONTINUOUS_MODE: true
  VALIDATION_REQUIRED: true
  SOCRATIC_THRESHOLD: 0.80
  MONTE_CARLO_THRESHOLD: 0.85
  ARENA_MODE_REQUIRED: true

workflow_integration:
  hcfp_full_auto:
    - branch_sync_automation
    - validation_integration
    - deployment_coordination
    
  windsurf_next:
    - change_detection
    - auto_commit_generation
    - development_sync
    
  arena_mode:
    - tournament_triggering
    - result_validation
    - promotion_coordination

success_metrics:
  automation_success_rate: > 95%
  validation_pass_rate: > 90%
  deployment_frequency: daily
  rollback_rate: < 5%
  time_to_production: < 1 hour

troubleshooting:
  common_issues:
    - HeadyBattle_validation_failure
    - monte_carlo_confidence_low
    - arena_mode_stuck
    - branch_conflicts
    
  diagnostic_commands:
    - check_branch_status
    - validate_configuration
    - review_validation_logs
    - monitor_automation_queue
